##
# rpm macros for old systems < el5
# (defined if bcond_with does not already exist)
# 
%if %{?bcond_with:0}%{!?bcond_with:1}
%define nil                    %{!?nil}
%define defined()      %{expand:%%{?%{1}:1}%%{!?%{1}:0}}
%define undefined()    %{expand:%%{?%{1}:0}%%{!?%{1}:1}}
%define with()         %{expand:%%{?with_%{1}:1}%%{!?with_%{1}:0}}
%define without()      %{expand:%%{?with_%{1}:0}%%{!?with_%{1}:1}}
%define bcond_with()           %{expand:%%{?_with_%{1}:%%global with_%{1} 1}}
%define bcond_without()        %{expand:%%{!?_without_%{1}:%%global with_%{1} 1}}
%endif

# target install dir for web gui
%define installdir_www  /var/www/html

###### end of macro definitions #####

Name: @PACKAGE@
Version: @VERSION@ 

Vendor: CEA/DAM
Prefix: %{_prefix}

Release: @RELEASE@.noarch

Summary: Robinhood - Policy engine and accounting tool for large filesystems
License: CeCILL 
Group: Applications/System
Url: http://robinhood.sourceforge.net
Source0: @PACKAGE@-%{version}.tar.gz
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)

%description
Robinhood is a tool for monitoring and purging file systems. It is designed to 
process all its tasks in parallel, so it is particulary adapted for managing
large file systems with millions of entries and petabytes of data.

Generated using options: @ac_configure_args@

%package webgui
Summary: Web interface to vizualize filesystems stats
Group: Applications/System

%description webgui
Web interface to vizualize filesystems stats.
This uses robinhood database to display misc. user and group stats.

%prep
%setup -q -n @PACKAGE@-%{version}

%build

%install
rm -rf $RPM_BUILD_ROOT
mkdir -p $RPM_BUILD_ROOT/%{installdir_www}/robinhood
cp -r web_gui/acct/*	$RPM_BUILD_ROOT/%{installdir_www}/robinhood/.

%clean
rm -rf $RPM_BUILD_ROOT

%files webgui

# set apache permissions
%defattr(750,root,apache)
%{installdir_www}/robinhood

%changelog

* Wed Aug 03 2011 Thomas Leibovici <thomas.leibovici@cea.fr> 2.3.2
- [webgui] Web interface (beta 1)
